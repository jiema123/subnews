# SubNews

SubNews æ˜¯ä¸€ä¸ªåŸºäº AI çš„æ–°é—»èšåˆä¸æ¨é€ Agentã€‚å®ƒå…è®¸ç”¨æˆ·è®¢é˜…ç½‘é¡µå†…å®¹ï¼Œåˆ©ç”¨ LLM (Gemini) è¿›è¡Œæ™ºèƒ½æå–å’Œæ€»ç»“ï¼Œå¹¶é€šè¿‡ Webhook å®šæ—¶æ¨é€åˆ°å¸¸ç”¨çš„å³æ—¶é€šè®¯å·¥å…·ï¼ˆé’‰é’‰ã€ä¼ä¸šå¾®ä¿¡ã€é£ä¹¦ã€Telegramï¼‰ã€‚

![Dashboard Screenshot](https://via.placeholder.com/800x450?text=SubNews+Dashboard)

## âœ¨ä¸»è¦ç‰¹æ€§

*   **æ™ºèƒ½è®¢é˜…**ï¼šæ”¯æŒä»»æ„ URL å†…å®¹æŠ“å–ï¼ˆæ•´åˆ Jina Reader APIï¼‰ã€‚
*   **AI æ€»ç»“**ï¼šé›†æˆ Google Gemini APIï¼Œè‡ªå®šä¹‰ Prompt æ¨¡æ¿æå–å…³é”®ä¿¡æ¯ã€‚
*   **å¤šå¹³å°æ”¯æŒ**ï¼šå†…ç½®é’‰é’‰ã€ä¼ä¸šå¾®ä¿¡ã€é£ä¹¦ã€Telegram çš„ Webhook æ¨é€é€‚é…ã€‚
*   **çµæ´»è°ƒåº¦**ï¼š
    *   æ”¯æŒâ€œæ¯å¤©â€å®šæ—¶æ¨é€ï¼ˆå¦‚æœé”™è¿‡ä¼šè¡¥æ¨ï¼‰ã€‚
    *   æ”¯æŒâ€œå•æ¬¡â€é¢„çº¦æ¨é€ã€‚
    *   åŸºäº Cloudflare Workers Cron å®ç°åˆ†é’Ÿçº§æ£€æŸ¥ã€‚
*   **å¯è§†åŒ–ç®¡ç†**ï¼š
    *   ç°ä»£åŒ–çš„ä»ªè¡¨ç›˜ç•Œé¢ï¼ˆGlassmorphism é£æ ¼ï¼‰ã€‚
    *   å®æ—¶é¢„è§ˆ & è°ƒè¯•åŠŸèƒ½ï¼Œæ‰€è§å³æ‰€å¾—ã€‚
    *   æ¨é€æ—¥å¿—è®°å½•ä¸æŸ¥çœ‹ã€‚
*   **Serverless æ¶æ„**ï¼šå®Œå…¨è¿è¡Œåœ¨ Cloudflare Workers å’Œ KV ä¸Šï¼Œä½æˆæœ¬ã€é«˜å¹¶å‘ã€‚

## ğŸ›  æŠ€æœ¯æ ˆ

*   **Frontend**: Vite, TypeScript, Vanilla JS/CSS (æ— é‡å‹æ¡†æ¶)
*   **Backend**: Cloudflare Workers, Hono, Cron Parser
*   **Database**: Cloudflare Workers KV
*   **AI Service**: Google Gemini Pro
*   **Content Parsing**: Jina Reader API

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å‰ç½®å‡†å¤‡

ç¡®ä¿ä½ å·²ç»å®‰è£…äº† [Node.js](https://nodejs.org/) (v18+) å’Œ [Make](https://www.gnu.org/software/make/) (å¯é€‰)ï¼Œå¹¶æ‹¥æœ‰ä»¥ä¸‹è´¦å·/API Keyï¼š

*   **Cloudflare Account** (ç”¨äºéƒ¨ç½² Workers å’Œ KV)
*   **Google Gemini API Key** (ç”¨äº AI æ€»ç»“)
*   **Jina Reader API Key** (ç”¨äºç½‘é¡µæŠ“å–)

### 2. å®‰è£…ä¾èµ–

åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œï¼š

```bash
# ä¸€é”®å®‰è£…å‰åç«¯æ‰€æœ‰ä¾èµ–
npm install 
npm run install-all
```

### 3. æœ¬åœ°å¼€å‘é…ç½®

#### 3.1é…ç½®åç«¯ç¯å¢ƒå˜é‡

åœ¨ `server/` ç›®å½•ä¸‹åˆ›å»º `.dev.vars` æ–‡ä»¶ï¼š

```bash
# server/.dev.vars
GEMINI_API_KEY="your_gemini_key_here"
JINA_API_KEY="your_jina_key_here"
```

#### 3.2 é…ç½® Wrangler

é¡¹ç›®ä½¿ç”¨ Cloudflare KV å­˜å‚¨æ•°æ®ã€‚
åœ¨æœ¬åœ°å¼€å‘æ—¶ï¼ŒWrangler ä¼šè‡ªåŠ¨åˆ›å»ºæœ¬åœ° KV å­˜å‚¨ã€‚

ç¡®ä¿ `server/wrangler.jsonc` é…ç½®æ–‡ä»¶æ­£ç¡®ã€‚
*æ³¨æ„ï¼šåœ¨æœ¬åœ°è°ƒè¯•æ—¶ï¼ŒKV çš„ `id` å»ºè®®å¯¹åº”æœ¬åœ°ç”Ÿæˆçš„æ–‡ä»¶å¤¹ ID æˆ–ä½¿ç”¨ `SUBNEWS_KV_ID` (å¦‚æœæœ¬åœ°å·²ç”Ÿæˆå¯¹åº”çŠ¶æ€æ–‡ä»¶å¤¹)ã€‚å‘å¸ƒä¸Šçº¿æ—¶éœ€æ”¹ä¸ºçœŸå®çš„ Cloudflare KV IDã€‚*

### 4. å¯åŠ¨æœ¬åœ°å¼€å‘

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
npm run dev
```

è¯¥å‘½ä»¤ä¼šåŒæ—¶å¯åŠ¨ï¼š
*   åç«¯ Worker (http://localhost:8787)
*   å‰ç«¯ Vite Server (http://localhost:5173)

### 5. éƒ¨ç½²ä¸Šçº¿

1.  **ç™»å½• Cloudflare**
    ```bash
    npx wrangler login
    ```

2.  **åˆ›å»º KV Namespace** (å¦‚æœå°šæœªåˆ›å»º)
    ```bash
    cd server
    npx wrangler kv:namespace create SUBNEWS_KV
    # è®°å½•ä¸‹æ§åˆ¶å°è¾“å‡ºçš„ idï¼Œå¡«å…¥ server/wrangler.jsonc çš„ kv_namespaces é…ç½®ä¸­
    ```

3.  **ä¸Šä¼  Secrets** (API Keys)
    ```bash
    cd server
    npx wrangler secret put GEMINI_API_KEY
    npx wrangler secret put JINA_API_KEY
    ```

4.  **ä¸€é”®éƒ¨ç½²**
    ```bash
    # åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
    npm run deploy
    ```
    æ­¤å‘½ä»¤ä¼šè‡ªåŠ¨æ„å»ºå‰ç«¯é™æ€èµ„æºï¼Œå¹¶å°†å…¶å‘å¸ƒåˆ° Cloudflare Workers Assetsã€‚

## ğŸ“– ä½¿ç”¨æŒ‡å—

### åˆ›å»ºè®¢é˜…ä»»åŠ¡

1.  ç™»å½• Dashboardã€‚
2.  ç‚¹å‡» **"+ æ–°å»ºä»»åŠ¡"**ã€‚
3.  å¡«å†™ä»»åŠ¡ä¿¡æ¯ï¼š
    *   **ç›®æ ‡ URL**ï¼šæ”¯æŒ `{{year}}`, `{{month}}`, `{{day}}` ç­‰æ—¥æœŸå˜é‡åŠ¨æ€ç”Ÿæˆ URLã€‚
    *   **è°ƒåº¦ç±»å‹**ï¼šé€‰æ‹©â€œæ¯å¤©â€æˆ–â€œå•æ¬¡â€ã€‚
    *   **æ¨é€å¹³å°**ï¼šé€‰æ‹©å¯¹åº”çš„ IM å¹³å°ã€‚
    *   **Webhook URL**ï¼šå¯¹åº”å¹³å°çš„æœºå™¨äºº Webhook åœ°å€ã€‚
    *   **æç¤ºè¯æ¨¡æ¿**ï¼šå‘Šè¯‰ AI ä½ å¸Œæœ›å¦‚ä½•æ€»ç»“è¿™ç¯‡æ–°é—»ï¼ˆä¾‹å¦‚ï¼šâ€œæ€»ç»“å‰5æ¡ç§‘æŠ€æ–°é—»ï¼Œè¾“å‡º Markdownâ€ï¼‰ã€‚
4.  ç‚¹å‡» **"è¿è¡Œè°ƒè¯•"** æŸ¥çœ‹ AI è¾“å‡ºæ•ˆæœã€‚
5.  ç‚¹å‡» **"ä¿å­˜ä»»åŠ¡"**ã€‚

### è·å– Webhook åœ°å€

*   **é’‰é’‰**ï¼šç¾¤è®¾ç½® -> æ™ºèƒ½ç¾¤åŠ©æ‰‹ -> æ·»åŠ æœºå™¨äºº -> è‡ªå®šä¹‰ (å®‰å…¨è®¾ç½®é€‰å…³é”®è¯æˆ–åŠ ç­¾)ã€‚
*   **ä¼ä¸šå¾®ä¿¡**ï¼šç¾¤è®¾ç½® -> æ·»åŠ ç¾¤æœºå™¨äºº -> å¤åˆ¶ Webhook åœ°å€ã€‚
*   **é£ä¹¦**ï¼šç¾¤è®¾ç½® -> ç¾¤æœºå™¨äºº -> æ·»åŠ æœºå™¨äºº -> è‡ªå®šä¹‰æœºå™¨äººã€‚
*   **Telegram**ï¼šè”ç³» @BotFather åˆ›å»º Bot è·å– Tokenï¼ŒWebhook éœ€è‡ªè¡Œæ‹¼æ¥æˆ–ä½¿ç”¨ç‰¹å®šçš„è½¬å‘æœåŠ¡ (æœ¬é¡¹ç›®ä¸»è¦é€‚é…å‰ä¸‰è€…åŠæ ‡å‡† Webhook)ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
subnews/
â”œâ”€â”€ client/                 # å‰ç«¯é¡¹ç›® (Vite)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.ts         #ä¸»è¦é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ style.css       # æ ·å¼
â”‚   â”‚   â””â”€â”€ services/       # API å°è£…
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ server/                 # åç«¯é¡¹ç›® (Cloudflare Workers)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ index.ts        # Worker å…¥å£ä¸ API è·¯ç”±
â”‚   â”‚   â””â”€â”€ types.ts        # ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ wrangler.jsonc      # Worker é…ç½®æ–‡ä»¶
â””â”€â”€ package.json            # æ ¹ç›®å½•è„šæœ¬ç®¡ç†
```

## âš ï¸ æ³¨æ„äº‹é¡¹

*   **æ—¶åŒºé—®é¢˜**ï¼šå®šæ—¶ä»»åŠ¡é»˜è®¤ä½¿ç”¨ **Asia/Shanghai (UTC+8)** æ—¶åŒºã€‚
*   **Worker é™åˆ¶**ï¼šCloudflare Workers å…è´¹ç‰ˆæœ‰ CPU æ—¶é—´å’Œè¯·æ±‚æ•°é™åˆ¶ï¼ŒGemini è¯·æ±‚è¾ƒæ…¢æ—¶å»ºè®®ä½¿ç”¨ `ctx.waitUntil` å¼‚æ­¥å¤„ç†ï¼ˆå·²å†…ç½®ï¼‰ã€‚

## License

ISC
